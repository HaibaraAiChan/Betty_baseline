main start at this time 1681959198.7618582
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
Epoch:  0
REG start----................................
Convert a graph into a bidirected graph: 3.155 seconds, peak memory: 34.202 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.202 GB
[02:54:18] /opt/dgl/src/graph/transform/metis_partition_hetero.cc:87: Partition a graph with 196571 nodes and 51428810 edges into 9 parts and get 4378759 edge cuts
Metis partitioning: 14.566 seconds, peak memory: 35.478 GB
Split the graph: 2.346 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
connection checking time:  22.024924278259277
block generation total time  22.37543559074402
average batch blocks generation time:  2.4861595100826688
----------------------------------------before batch input features to device
 Nvidia-smi: 1.345703125 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.50390625 GB
    Memory Allocated: 0.16074657440185547  GigaBytes
Max Memory Allocated: 0.16074657440185547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.50390625 GB
    Memory Allocated: 0.1609053611755371  GigaBytes
Max Memory Allocated: 0.1609053611755371  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 20.634765625 GB
    Memory Allocated: 0.1795053482055664  GigaBytes
Max Memory Allocated: 18.02498197555542  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.634765625 GB
    Memory Allocated: 0.31706857681274414  GigaBytes
Max Memory Allocated: 18.02498197555542  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.634765625 GB
    Memory Allocated: 0.3172268867492676  GigaBytes
Max Memory Allocated: 18.02498197555542  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 20.90234375 GB
    Memory Allocated: 0.17164134979248047  GigaBytes
Max Memory Allocated: 18.02498197555542  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.90234375 GB
    Memory Allocated: 0.3223586082458496  GigaBytes
Max Memory Allocated: 18.02498197555542  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.90234375 GB
    Memory Allocated: 0.3225264549255371  GigaBytes
Max Memory Allocated: 18.02498197555542  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 21.748046875 GB
    Memory Allocated: 0.19917583465576172  GigaBytes
Max Memory Allocated: 18.871477127075195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.748046875 GB
    Memory Allocated: 0.35278987884521484  GigaBytes
Max Memory Allocated: 18.871477127075195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.748046875 GB
    Memory Allocated: 0.3529486656188965  GigaBytes
Max Memory Allocated: 18.871477127075195  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 21.748046875 GB
    Memory Allocated: 0.21450138092041016  GigaBytes
Max Memory Allocated: 18.871477127075195  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.748046875 GB
    Memory Allocated: 0.3908100128173828  GigaBytes
Max Memory Allocated: 18.871477127075195  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.748046875 GB
    Memory Allocated: 0.3909769058227539  GigaBytes
Max Memory Allocated: 18.871477127075195  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 23.013671875 GB
    Memory Allocated: 0.25171899795532227  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.013671875 GB
    Memory Allocated: 0.43952131271362305  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.013671875 GB
    Memory Allocated: 0.4396824836730957  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 23.279296875 GB
    Memory Allocated: 0.27629661560058594  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.279296875 GB
    Memory Allocated: 0.4792938232421875  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.279296875 GB
    Memory Allocated: 0.47945547103881836  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 23.392578125 GB
    Memory Allocated: 0.305361270904541  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.392578125 GB
    Memory Allocated: 0.4701404571533203  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.392578125 GB
    Memory Allocated: 0.4703073501586914  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
----------------------------------------before batch input features to device
 Nvidia-smi: 23.392578125 GB
    Memory Allocated: 0.2815127372741699  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.392578125 GB
    Memory Allocated: 0.45551061630249023  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.392578125 GB
    Memory Allocated: 0.4556765556335449  GigaBytes
Max Memory Allocated: 20.415147304534912  GigaBytes

number of bucket  10
[ 1  2  3  4  5  6  7  8  9 10]
number of bucket  25
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25]
times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14979089630974662 |0.07481813430786133 |0.29122696982489693 |0.00015470716688368056 |0.23714394039577907 |0.00979757308959961 |
----------------------------------------------------------pseudo_mini_loss sum 5.388457298278809