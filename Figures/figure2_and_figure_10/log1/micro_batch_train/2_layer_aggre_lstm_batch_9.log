main start at this time 1668821930.4035907
-----------------------------------------before load data 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.166015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
REG start----................................
Convert a graph into a bidirected graph: 3.107 seconds, peak memory: 34.142 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 34.142 GB
Metis partitioning: 13.601 seconds, peak memory: 35.427 GB
Split the graph: 1.454 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
connection checking time:  13.842209339141846
block generation total time  13.229444742202759
average batch blocks generation time:  1.4699383046891954
block dataloader generation time/epoch 57.452664375305176
pseudo mini batch 0 input nodes size: 420543
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.33984375 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.33984375 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.498046875 GB
    Memory Allocated: 0.1592082977294922  GigaBytes
Max Memory Allocated: 0.1592082977294922  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.498046875 GB
    Memory Allocated: 0.15936708450317383  GigaBytes
Max Memory Allocated: 0.15936708450317383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.498046875 GB
    Memory Allocated: 0.15936708450317383  GigaBytes
Max Memory Allocated: 0.15936708450317383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.17448854446411133  GigaBytes
Max Memory Allocated: 0.17448854446411133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.17448854446411133  GigaBytes
Max Memory Allocated: 0.17448854446411133  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.60546875 GB
    Memory Allocated: 0.17448854446411133  GigaBytes
Max Memory Allocated: 0.17448854446411133  GigaBytes

m.shape torch.Size([342, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.314453125 GB
    Memory Allocated: 0.7545170783996582  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.314453125 GB
    Memory Allocated: 0.7545170783996582  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

 h.shape torch.Size([1, 342, 100]), torch.Size([1, 342, 100])
----------------------------------------3
 Nvidia-smi: 2.314453125 GB
    Memory Allocated: 0.7547726631164551  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.326171875 GB
    Memory Allocated: 0.7568130493164062  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

rst.shape  torch.Size([1, 342, 100])
m.shape torch.Size([530, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.326171875 GB
    Memory Allocated: 0.7570805549621582  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.326171875 GB
    Memory Allocated: 0.7570805549621582  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

 h.shape torch.Size([1, 530, 100]), torch.Size([1, 530, 100])
----------------------------------------3
 Nvidia-smi: 2.326171875 GB
    Memory Allocated: 0.7574763298034668  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.33203125 GB
    Memory Allocated: 0.763404369354248  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

rst.shape  torch.Size([1, 530, 100])
m.shape torch.Size([748, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.333984375 GB
    Memory Allocated: 0.764042854309082  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.333984375 GB
    Memory Allocated: 0.764042854309082  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

 h.shape torch.Size([1, 748, 100]), torch.Size([1, 748, 100])
----------------------------------------3
 Nvidia-smi: 2.333984375 GB
    Memory Allocated: 0.7646007537841797  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3359375 GB
    Memory Allocated: 0.7773642539978027  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

rst.shape  torch.Size([1, 748, 100])
m.shape torch.Size([1012, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.3359375 GB
    Memory Allocated: 0.7785935401916504  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3359375 GB
    Memory Allocated: 0.7785935401916504  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

 h.shape torch.Size([1, 1012, 100]), torch.Size([1, 1012, 100])
----------------------------------------3
 Nvidia-smi: 2.3359375 GB
    Memory Allocated: 0.7793478965759277  GigaBytes
Max Memory Allocated: 0.796968936920166  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.33984375 GB
    Memory Allocated: 0.8012185096740723  GigaBytes
Max Memory Allocated: 0.8027267456054688  GigaBytes

rst.shape  torch.Size([1, 1012, 100])
m.shape torch.Size([1219, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.33984375 GB
    Memory Allocated: 0.8035106658935547  GigaBytes
Max Memory Allocated: 0.8035793304443359  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.33984375 GB
    Memory Allocated: 0.8035106658935547  GigaBytes
Max Memory Allocated: 0.8035793304443359  GigaBytes

 h.shape torch.Size([1, 1219, 100]), torch.Size([1, 1219, 100])
----------------------------------------3
 Nvidia-smi: 2.341796875 GB
    Memory Allocated: 0.8044195175170898  GigaBytes
Max Memory Allocated: 0.8044195175170898  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3671875 GB
    Memory Allocated: 0.8371238708496094  GigaBytes
Max Memory Allocated: 0.8393945693969727  GigaBytes

rst.shape  torch.Size([1, 1219, 100])
m.shape torch.Size([1339, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.3671875 GB
    Memory Allocated: 0.8396625518798828  GigaBytes
Max Memory Allocated: 0.8397526741027832  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3671875 GB
    Memory Allocated: 0.8396625518798828  GigaBytes
Max Memory Allocated: 0.8397526741027832  GigaBytes

 h.shape torch.Size([1, 1339, 100]), torch.Size([1, 1339, 100])
----------------------------------------3
 Nvidia-smi: 2.3671875 GB
    Memory Allocated: 0.8406610488891602  GigaBytes
Max Memory Allocated: 0.8406610488891602  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.416015625 GB
    Memory Allocated: 0.883570671081543  GigaBytes
Max Memory Allocated: 0.886563777923584  GigaBytes

rst.shape  torch.Size([1, 1339, 100])
m.shape torch.Size([1396, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.416015625 GB
    Memory Allocated: 0.8867120742797852  GigaBytes
Max Memory Allocated: 0.8868217468261719  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.416015625 GB
    Memory Allocated: 0.8867120742797852  GigaBytes
Max Memory Allocated: 0.8868217468261719  GigaBytes

 h.shape torch.Size([1, 1396, 100]), torch.Size([1, 1396, 100])
----------------------------------------3
 Nvidia-smi: 2.41796875 GB
    Memory Allocated: 0.8877525329589844  GigaBytes
Max Memory Allocated: 0.8877525329589844  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.486328125 GB
    Memory Allocated: 0.9413800239562988  GigaBytes
Max Memory Allocated: 0.9450206756591797  GigaBytes

rst.shape  torch.Size([1, 1396, 100])
m.shape torch.Size([1469, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.486328125 GB
    Memory Allocated: 0.9452381134033203  GigaBytes
Max Memory Allocated: 0.9453697204589844  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.486328125 GB
    Memory Allocated: 0.9452381134033203  GigaBytes
Max Memory Allocated: 0.9453697204589844  GigaBytes

 h.shape torch.Size([1, 1469, 100]), torch.Size([1, 1469, 100])
----------------------------------------3
 Nvidia-smi: 2.48828125 GB
    Memory Allocated: 0.9463329315185547  GigaBytes
Max Memory Allocated: 0.9463329315185547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.55859375 GB
    Memory Allocated: 1.0088810920715332  GigaBytes
Max Memory Allocated: 1.0132594108581543  GigaBytes

rst.shape  torch.Size([1, 1469, 100])
m.shape torch.Size([1485, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.55859375 GB
    Memory Allocated: 1.013312816619873  GigaBytes
Max Memory Allocated: 1.0134625434875488  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.55859375 GB
    Memory Allocated: 1.013312816619873  GigaBytes
Max Memory Allocated: 1.0134625434875488  GigaBytes

 h.shape torch.Size([1, 1485, 100]), torch.Size([1, 1485, 100])
----------------------------------------3
 Nvidia-smi: 2.55859375 GB
    Memory Allocated: 1.0144200325012207  GigaBytes
Max Memory Allocated: 1.0144200325012207  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.650390625 GB
    Memory Allocated: 1.0852432250976562  GigaBytes
Max Memory Allocated: 1.0902223587036133  GigaBytes

rst.shape  torch.Size([1, 1485, 100])
m.shape torch.Size([145097, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.2109375 GB
    Memory Allocated: 1.6257052421569824  GigaBytes
Max Memory Allocated: 1.6419215202331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2109375 GB
    Memory Allocated: 1.6257052421569824  GigaBytes
Max Memory Allocated: 1.6419215202331543  GigaBytes

 h.shape torch.Size([1, 145097, 100]), torch.Size([1, 145097, 100])
----------------------------------------3
 Nvidia-smi: 3.3203125 GB
    Memory Allocated: 1.7350802421569824  GigaBytes
Max Memory Allocated: 1.7350802421569824  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.568359375 GB
    Memory Allocated: 9.442111492156982  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 145097, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.568359375 GB
    Memory Allocated: 8.879002571105957  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.568359375 GB
    Memory Allocated: 9.02647590637207  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.568359375 GB
    Memory Allocated: 9.209279537200928  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712194442749023  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712194442749023  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.71223258972168  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.71253776550293  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712538242340088  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712538242340088  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712557315826416  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712843418121338  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712882995605469  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712882995605469  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.712915420532227  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.713628768920898  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([41, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.713770389556885  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.713770389556885  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.71384859085083  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.716116428375244  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([24, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.716192722320557  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.716192722320557  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.716238498687744  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.717886447906494  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.718071460723877  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.718071460723877  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.718140125274658  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.721092700958252  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.721267223358154  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.721267223358154  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.721326351165771  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.72428274154663  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.72453784942627  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.72453784942627  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.724608421325684  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.728631019592285  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([60, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.729115009307861  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.729115009307861  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 12.06640625 GB
    Memory Allocated: 9.72922945022583  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.07421875 GB
    Memory Allocated: 9.73655366897583  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([33, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.07421875 GB
    Memory Allocated: 9.736814022064209  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.07421875 GB
    Memory Allocated: 9.736814022064209  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 12.07421875 GB
    Memory Allocated: 9.736876964569092  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.078125 GB
    Memory Allocated: 9.741345882415771  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([40, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.078125 GB
    Memory Allocated: 9.741737365722656  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.078125 GB
    Memory Allocated: 9.741737365722656  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 12.078125 GB
    Memory Allocated: 9.741813659667969  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0859375 GB
    Memory Allocated: 9.747764587402344  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.0859375 GB
    Memory Allocated: 9.748118877410889  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0859375 GB
    Memory Allocated: 9.748118877410889  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 12.0859375 GB
    Memory Allocated: 9.748183727264404  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.091796875 GB
    Memory Allocated: 9.753695964813232  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.091796875 GB
    Memory Allocated: 9.75403881072998  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.091796875 GB
    Memory Allocated: 9.75403881072998  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 12.091796875 GB
    Memory Allocated: 9.754096031188965  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.095703125 GB
    Memory Allocated: 9.759360313415527  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.09765625 GB
    Memory Allocated: 9.759870052337646  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.09765625 GB
    Memory Allocated: 9.759870052337646  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 12.09765625 GB
    Memory Allocated: 9.759946346282959  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.10546875 GB
    Memory Allocated: 9.767499446868896  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.10546875 GB
    Memory Allocated: 9.768297672271729  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.10546875 GB
    Memory Allocated: 9.768297672271729  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 12.10546875 GB
    Memory Allocated: 9.768408298492432  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1171875 GB
    Memory Allocated: 9.780134677886963  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.1171875 GB
    Memory Allocated: 9.780648708343506  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1171875 GB
    Memory Allocated: 9.780648708343506  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 12.1171875 GB
    Memory Allocated: 9.78071928024292  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.126953125 GB
    Memory Allocated: 9.788693904876709  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.126953125 GB
    Memory Allocated: 9.789345264434814  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.126953125 GB
    Memory Allocated: 9.789345264434814  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 12.126953125 GB
    Memory Allocated: 9.789425373077393  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.13671875 GB
    Memory Allocated: 9.799038410186768  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.13671875 GB
    Memory Allocated: 9.799742698669434  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.13671875 GB
    Memory Allocated: 9.799742698669434  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 12.13671875 GB
    Memory Allocated: 9.799824714660645  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1484375 GB
    Memory Allocated: 9.810240745544434  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.1484375 GB
    Memory Allocated: 9.810875415802002  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1484375 GB
    Memory Allocated: 9.810875415802002  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 12.1484375 GB
    Memory Allocated: 9.810945987701416  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.158203125 GB
    Memory Allocated: 9.8204026222229  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.16015625 GB
    Memory Allocated: 9.82125186920166  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.16015625 GB
    Memory Allocated: 9.82125186920166  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 12.16015625 GB
    Memory Allocated: 9.82133960723877  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.171875 GB
    Memory Allocated: 9.833710670471191  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.171875 GB
    Memory Allocated: 9.834434032440186  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.171875 GB
    Memory Allocated: 9.834434032440186  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 12.171875 GB
    Memory Allocated: 9.834506511688232  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.18359375 GB
    Memory Allocated: 9.84523344039917  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.185546875 GB
    Memory Allocated: 9.846127986907959  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.185546875 GB
    Memory Allocated: 9.846127986907959  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 12.185546875 GB
    Memory Allocated: 9.846211910247803  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.197265625 GB
    Memory Allocated: 9.859220027923584  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.197265625 GB
    Memory Allocated: 9.859930038452148  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.197265625 GB
    Memory Allocated: 9.859930038452148  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 12.197265625 GB
    Memory Allocated: 9.859994888305664  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.208984375 GB
    Memory Allocated: 9.870500564575195  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([47, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.208984375 GB
    Memory Allocated: 9.8717041015625  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.208984375 GB
    Memory Allocated: 9.8717041015625  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 12.208984375 GB
    Memory Allocated: 9.871793746948242  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.224609375 GB
    Memory Allocated: 9.886943817138672  GigaBytes
Max Memory Allocated: 9.983127117156982  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([20391, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.7109375 GB
    Memory Allocated: 10.377025604248047  GigaBytes
Max Memory Allocated: 10.378947257995605  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.7109375 GB
    Memory Allocated: 10.377025604248047  GigaBytes
Max Memory Allocated: 10.378947257995605  GigaBytes

 h.shape torch.Size([1, 20391, 256]), torch.Size([1, 20391, 256])
----------------------------------------3
 Nvidia-smi: 12.7109375 GB
    Memory Allocated: 10.416003227233887  GigaBytes
Max Memory Allocated: 10.416003227233887  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.408203125 GB
    Memory Allocated: 17.28811740875244  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 20391, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.408203125 GB
    Memory Allocated: 16.790323734283447  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.408203125 GB
    Memory Allocated: 16.794048309326172  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.408203125 GB
    Memory Allocated: 16.797614097595215  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.408203125 GB
    Memory Allocated: 16.801514625549316  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.20137929916381836  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

pseudo mini batch 1 input nodes size: 394239
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.17833614349365234  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.17833614349365234  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.32520198822021484  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.3253602981567383  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.16853666305541992  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.1839456558227539  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.1839456558227539  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.416015625 GB
    Memory Allocated: 0.1839456558227539  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

m.shape torch.Size([414, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7668952941894531  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7668952941894531  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 414, 100]), torch.Size([1, 414, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7672042846679688  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7696733474731445  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 414, 100])
m.shape torch.Size([671, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7700190544128418  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7700190544128418  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 671, 100]), torch.Size([1, 671, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7705197334289551  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7792887687683105  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 671, 100])
m.shape torch.Size([879, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7800211906433105  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7800211906433105  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 879, 100]), torch.Size([1, 879, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7806763648986816  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7955498695373535  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 879, 100])
m.shape torch.Size([1187, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7969913482666016  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7969913482666016  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1187, 100]), torch.Size([1, 1187, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.7978763580322266  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8235301971435547  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1187, 100])
m.shape torch.Size([1474, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8258333206176758  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8258333206176758  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1474, 100]), torch.Size([1, 1474, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8269319534301758  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.866724967956543  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1474, 100])
m.shape torch.Size([1643, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8698482513427734  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8698482513427734  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1643, 100]), torch.Size([1, 1643, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.8710727691650391  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.9237184524536133  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1643, 100])
m.shape torch.Size([1846, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.9279203414916992  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.9279203414916992  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1846, 100]), torch.Size([1, 1846, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.9292964935302734  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 0.9995870590209961  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1846, 100])
m.shape torch.Size([1917, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0046124458312988  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0046124458312988  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1917, 100]), torch.Size([1, 1917, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0060410499572754  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0874600410461426  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1917, 100])
m.shape torch.Size([1973, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0933609008789062  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0933609008789062  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1973, 100]), torch.Size([1, 1973, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.0948314666748047  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.1889219284057617  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1973, 100])
m.shape torch.Size([144485, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.726435661315918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.726435661315918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 144485, 100]), torch.Size([1, 144485, 100])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 1.835810661315918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.497923851013184  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 144485, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 8.932538032531738  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.081777572631836  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.26713514328003  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

m.shape torch.Size([70, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.750535488128662  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.750535488128662  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.750669002532959  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.751737117767334  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([71, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.75180721282959  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.75180721282959  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.75194263458252  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.753973960876465  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([68, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.75410270690918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.75410270690918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.754232406616211  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.757085800170898  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([102, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.757413387298584  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.757413387298584  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.75760793685913  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.76324987411499  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([90, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.763585567474365  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.763585567474365  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.763757228851318  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.76993703842163  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([110, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.770485877990723  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.770485877990723  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.770695686340332  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.779717445373535  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([119, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.780413627624512  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.780413627624512  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.780640602111816  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.79198932647705  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([120, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.792798519134521  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.792798519134521  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.793027400970459  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.806073665618896  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([95, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.80678129196167  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.80678129196167  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.806962490081787  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.818559169769287  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([107, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.819965839385986  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.819965839385986  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.820169925689697  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.834660053253174  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([96, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.836063385009766  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.836063385009766  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.836246490478516  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.850528717041016  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([84, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.85140609741211  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.85140609741211  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.851566314697266  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.865184783935547  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([102, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.866611957550049  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.866611957550049  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.866806507110596  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.884705066680908  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([99, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.886115550994873  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.886115550994873  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.886304378509521  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.904998302459717  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([100, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.906412601470947  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.906412601470947  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 20.982421875 GB
    Memory Allocated: 9.906603336334229  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.986328125 GB
    Memory Allocated: 9.926821231842041  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([88, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.986328125 GB
    Memory Allocated: 9.928233623504639  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.986328125 GB
    Memory Allocated: 9.928233623504639  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 20.986328125 GB
    Memory Allocated: 9.928401470184326  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.005859375 GB
    Memory Allocated: 9.947368144989014  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([106, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.005859375 GB
    Memory Allocated: 9.949188232421875  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.005859375 GB
    Memory Allocated: 9.949188232421875  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 21.005859375 GB
    Memory Allocated: 9.949390411376953  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.03125 GB
    Memory Allocated: 9.973651885986328  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.03125 GB
    Memory Allocated: 9.975234985351562  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.03125 GB
    Memory Allocated: 9.975234985351562  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 21.03125 GB
    Memory Allocated: 9.975419998168945  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0546875 GB
    Memory Allocated: 9.998916625976562  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([104, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.0546875 GB
    Memory Allocated: 10.000729084014893  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0546875 GB
    Memory Allocated: 10.000729084014893  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 21.0546875 GB
    Memory Allocated: 10.000927448272705  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.08203125 GB
    Memory Allocated: 10.02750825881958  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([75, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.08203125 GB
    Memory Allocated: 10.028917789459229  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.08203125 GB
    Memory Allocated: 10.028917789459229  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 21.08203125 GB
    Memory Allocated: 10.02906084060669  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.103515625 GB
    Memory Allocated: 10.049231052398682  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([87, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.103515625 GB
    Memory Allocated: 10.051326751708984  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.103515625 GB
    Memory Allocated: 10.051326751708984  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 21.103515625 GB
    Memory Allocated: 10.051492691040039  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.12890625 GB
    Memory Allocated: 10.076051712036133  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([93, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.12890625 GB
    Memory Allocated: 10.078374862670898  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.12890625 GB
    Memory Allocated: 10.078374862670898  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 21.12890625 GB
    Memory Allocated: 10.07855224609375  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.15625 GB
    Memory Allocated: 10.106046676635742  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([89, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.15625 GB
    Memory Allocated: 10.10836410522461  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.15625 GB
    Memory Allocated: 10.10836410522461  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 21.15625 GB
    Memory Allocated: 10.10853385925293  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.18359375 GB
    Memory Allocated: 10.13603401184082  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([103, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.18359375 GB
    Memory Allocated: 10.13835859298706  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.18359375 GB
    Memory Allocated: 10.13835859298706  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 21.18359375 GB
    Memory Allocated: 10.13855504989624  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 10.171756267547607  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([18930, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 10.626510620117188  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 10.626510620117188  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 18930, 256]), torch.Size([1, 18930, 256])
----------------------------------------3
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 10.662616729736328  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 17.017820358276367  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 18930, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 16.540833473205566  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 16.544888973236084  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 16.544719219207764  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.21875 GB
    Memory Allocated: 16.54843282699585  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.2048015594482422  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

pseudo mini batch 2 input nodes size: 425997
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.18119478225708008  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.18119478225708008  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.3398914337158203  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.34005260467529297  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.19302845001220703  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.20934677124023438  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.20934677124023438  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.22265625 GB
    Memory Allocated: 0.20934677124023438  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

m.shape torch.Size([604, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8502273559570312  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8502273559570312  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 604, 100]), torch.Size([1, 604, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.850677490234375  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.854278564453125  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 604, 100])
m.shape torch.Size([961, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8547697067260742  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8547697067260742  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 961, 100]), torch.Size([1, 961, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8554859161376953  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8669223785400391  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 961, 100])
m.shape torch.Size([1299, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.868016242980957  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.868016242980957  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1299, 100]), torch.Size([1, 1299, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8689842224121094  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8906803131103516  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1299, 100])
m.shape torch.Size([1782, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8928518295288086  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8928518295288086  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 1782, 100]), torch.Size([1, 1782, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.8941802978515625  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.9332752227783203  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 1782, 100])
m.shape torch.Size([2021, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.9369115829467773  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.9369115829467773  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 2021, 100]), torch.Size([1, 2021, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.9384174346923828  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.9926280975341797  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 2021, 100])
m.shape torch.Size([2173, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.996732234954834  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.996732234954834  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 2173, 100]), torch.Size([1, 2173, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 0.9983515739440918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.068178653717041  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 2173, 100])
m.shape torch.Size([2195, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.0730929374694824  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.0730929374694824  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 2195, 100]), torch.Size([1, 2195, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.0747284889221191  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.157327651977539  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 2195, 100])
m.shape torch.Size([2302, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.1633706092834473  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.1633706092834473  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 2302, 100]), torch.Size([1, 2302, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.165086269378662  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.2628560066223145  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 2302, 100])
m.shape torch.Size([2358, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.2699041366577148  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.2699041366577148  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 2358, 100]), torch.Size([1, 2358, 100])
----------------------------------------3
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.2716617584228516  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.845703125 GB
    Memory Allocated: 1.384110927581787  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 2358, 100])
m.shape torch.Size([157706, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.43359375 GB
    Memory Allocated: 1.9711227416992188  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.43359375 GB
    Memory Allocated: 1.9711227416992188  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 157706, 100]), torch.Size([1, 157706, 100])
----------------------------------------3
 Nvidia-smi: 22.43359375 GB
    Memory Allocated: 2.088623046875  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.181640625 GB
    Memory Allocated: 10.431144714355469  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 157706, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.181640625 GB
    Memory Allocated: 9.81212854385376  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.181640625 GB
    Memory Allocated: 9.97749662399292  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.181640625 GB
    Memory Allocated: 10.182820796966553  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

m.shape torch.Size([21, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.6856369972229  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.6856369972229  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.68567705154419  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.685997486114502  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.686023712158203  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.686023712158203  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.68606948852539  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.686756134033203  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([36, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.686837196350098  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.686837196350098  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.686905860900879  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.688416481018066  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([53, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.688586235046387  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.688586235046387  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.688687324523926  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.691618919372559  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([54, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.69182825088501  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.69182825088501  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.691931247711182  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.69563913345337  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([71, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.69599723815918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.69599723815918  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.69613265991211  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.701955795288086  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([62, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.702305316925049  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.702305316925049  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.702423572540283  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.708336353302002  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([68, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.708800315856934  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.708800315856934  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 13.6796875 GB
    Memory Allocated: 10.708930015563965  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.681640625 GB
    Memory Allocated: 10.716322898864746  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([58, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.681640625 GB
    Memory Allocated: 10.716760158538818  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.681640625 GB
    Memory Allocated: 10.716760158538818  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 13.681640625 GB
    Memory Allocated: 10.716870784759521  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.689453125 GB
    Memory Allocated: 10.723950862884521  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([74, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.689453125 GB
    Memory Allocated: 10.724606990814209  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.689453125 GB
    Memory Allocated: 10.724606990814209  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 13.689453125 GB
    Memory Allocated: 10.724748134613037  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.701171875 GB
    Memory Allocated: 10.734769344329834  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([100, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.701171875 GB
    Memory Allocated: 10.735839366912842  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.701171875 GB
    Memory Allocated: 10.735839366912842  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 13.701171875 GB
    Memory Allocated: 10.736030101776123  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.71484375 GB
    Memory Allocated: 10.75090742111206  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([75, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.716796875 GB
    Memory Allocated: 10.751677513122559  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.716796875 GB
    Memory Allocated: 10.751677513122559  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 13.716796875 GB
    Memory Allocated: 10.75182056427002  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.73046875 GB
    Memory Allocated: 10.7639799118042  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([86, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.73046875 GB
    Memory Allocated: 10.765084266662598  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.73046875 GB
    Memory Allocated: 10.765084266662598  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 13.73046875 GB
    Memory Allocated: 10.76524829864502  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.744140625 GB
    Memory Allocated: 10.780339241027832  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.744140625 GB
    Memory Allocated: 10.781469821929932  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.744140625 GB
    Memory Allocated: 10.781469821929932  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 13.744140625 GB
    Memory Allocated: 10.781612873077393  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7578125 GB
    Memory Allocated: 10.795774936676025  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([66, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.759765625 GB
    Memory Allocated: 10.796655178070068  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.759765625 GB
    Memory Allocated: 10.796655178070068  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 13.759765625 GB
    Memory Allocated: 10.796781063079834  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7734375 GB
    Memory Allocated: 10.81012487411499  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([78, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7734375 GB
    Memory Allocated: 10.811398983001709  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7734375 GB
    Memory Allocated: 10.811398983001709  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 13.7734375 GB
    Memory Allocated: 10.811547756195068  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7890625 GB
    Memory Allocated: 10.828359127044678  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7890625 GB
    Memory Allocated: 10.829621315002441  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7890625 GB
    Memory Allocated: 10.829621315002441  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 13.7890625 GB
    Memory Allocated: 10.829756736755371  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.806640625 GB
    Memory Allocated: 10.846007347106934  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.806640625 GB
    Memory Allocated: 10.847275733947754  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.806640625 GB
    Memory Allocated: 10.847275733947754  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 13.806640625 GB
    Memory Allocated: 10.847397804260254  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.822265625 GB
    Memory Allocated: 10.862900733947754  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([77, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.822265625 GB
    Memory Allocated: 10.864430904388428  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.822265625 GB
    Memory Allocated: 10.864430904388428  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 13.822265625 GB
    Memory Allocated: 10.864577770233154  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.841796875 GB
    Memory Allocated: 10.884257793426514  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([70, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.841796875 GB
    Memory Allocated: 10.88599157333374  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.841796875 GB
    Memory Allocated: 10.88599157333374  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 13.841796875 GB
    Memory Allocated: 10.886125087738037  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.861328125 GB
    Memory Allocated: 10.904950618743896  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.861328125 GB
    Memory Allocated: 10.906693935394287  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.861328125 GB
    Memory Allocated: 10.906693935394287  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 13.861328125 GB
    Memory Allocated: 10.906854152679443  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.884765625 GB
    Memory Allocated: 10.930566310882568  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.884765625 GB
    Memory Allocated: 10.9324631690979  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.884765625 GB
    Memory Allocated: 10.9324631690979  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 13.88671875 GB
    Memory Allocated: 10.93263292312622  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.912109375 GB
    Memory Allocated: 10.95894479751587  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([87, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.912109375 GB
    Memory Allocated: 10.960837364196777  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.912109375 GB
    Memory Allocated: 10.960837364196777  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 13.912109375 GB
    Memory Allocated: 10.961003303527832  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.939453125 GB
    Memory Allocated: 10.987885475158691  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([72, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.939453125 GB
    Memory Allocated: 10.989612102508545  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.939453125 GB
    Memory Allocated: 10.989612102508545  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 13.939453125 GB
    Memory Allocated: 10.989749431610107  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.962890625 GB
    Memory Allocated: 11.01295804977417  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([19955, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.439453125 GB
    Memory Allocated: 11.493168830871582  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.439453125 GB
    Memory Allocated: 11.493168830871582  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

 h.shape torch.Size([1, 19955, 256]), torch.Size([1, 19955, 256])
----------------------------------------3
 Nvidia-smi: 14.439453125 GB
    Memory Allocated: 11.5319185256958  GigaBytes
Max Memory Allocated: 17.77444553375244  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.46875 GB
    Memory Allocated: 18.25059413909912  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 19955, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.46875 GB
    Memory Allocated: 17.75266456604004  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.46875 GB
    Memory Allocated: 17.756441593170166  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.46875 GB
    Memory Allocated: 17.756001949310303  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.46875 GB
    Memory Allocated: 17.759779453277588  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.23072385787963867  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

pseudo mini batch 3 input nodes size: 389730
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.20520973205566406  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.20520973205566406  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.35039567947387695  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.3505539894104004  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.1916961669921875  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.20725059509277344  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.20725059509277344  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.20725059509277344  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

m.shape torch.Size([607, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.778111457824707  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.778111457824707  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 607, 100]), torch.Size([1, 607, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.778564453125  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7821841239929199  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 607, 100])
m.shape torch.Size([1017, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7827157974243164  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7827157974243164  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 1017, 100]), torch.Size([1, 1017, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7834739685058594  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7949800491333008  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 1017, 100])
m.shape torch.Size([1465, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7962384223937988  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.7962384223937988  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 1465, 100]), torch.Size([1, 1465, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.797330379486084  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.821469783782959  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 1465, 100])
m.shape torch.Size([1796, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8236002922058105  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8236002922058105  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 1796, 100]), torch.Size([1, 1796, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8249392509460449  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8637518882751465  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 1796, 100])
m.shape torch.Size([1991, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8667912483215332  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8667912483215332  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 1991, 100]), torch.Size([1, 1991, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.8682751655578613  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.9218692779541016  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 1991, 100])
m.shape torch.Size([2168, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.9268288612365723  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.9268288612365723  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 2168, 100]), torch.Size([1, 2168, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.9284443855285645  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 0.9979033470153809  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 2168, 100])
m.shape torch.Size([2369, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.0032734870910645  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.0032734870910645  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 2369, 100]), torch.Size([1, 2369, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.0050387382507324  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.0933012962341309  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 2369, 100])
m.shape torch.Size([2385, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.0995268821716309  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.0995268821716309  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 2385, 100]), torch.Size([1, 2385, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.101304531097412  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.2026076316833496  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 2385, 100])
m.shape torch.Size([2361, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.2105870246887207  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.2105870246887207  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 2361, 100]), torch.Size([1, 2361, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.2123465538024902  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.324944019317627  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 2361, 100])
m.shape torch.Size([138736, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.8408961296081543  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.8408961296081543  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 138736, 100]), torch.Size([1, 138736, 100])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 1.944262981414795  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.283280849456787  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 138736, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 8.734229564666748  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 8.881948947906494  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.064758777618408  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.558126449584961  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.558126449584961  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.558151245117188  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.558349609375  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([30, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.55839490890503  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.55839490890503  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.558452129364014  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.55931043624878  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.55940294265747  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.55940294265747  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.559483051300049  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.561245441436768  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([48, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.561389923095703  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.561389923095703  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.561481475830078  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.564136505126953  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([65, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.564403533935547  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.564403533935547  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.56452751159668  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.568990707397461  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([56, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.569252014160156  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.569252014160156  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.569358825683594  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.573951721191406  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([66, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.574342727661133  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.574342727661133  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.574468612670898  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.58076286315918  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([59, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.581153869628906  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.581153869628906  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.581266403198242  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.58768081665039  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([62, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.588160991668701  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.588160991668701  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.588279247283936  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.595847606658936  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([73, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.596490383148193  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.596490383148193  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.596629619598389  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.606515407562256  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([57, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.607048511505127  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.607048511505127  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.607157230377197  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.615637302398682  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([69, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.616378784179688  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.616378784179688  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.616510391235352  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.627696990966797  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([92, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.628867149353027  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.628867149353027  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.629042625427246  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.645186424255371  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([92, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.646533966064453  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.646533966064453  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.646709442138672  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.664081573486328  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([74, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.66513442993164  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.66513442993164  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.665275573730469  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.68023681640625  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([81, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.681630611419678  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.681630611419678  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.681785106658936  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.699243068695068  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([89, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.700658321380615  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.700658321380615  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.700828075408936  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.721198558807373  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([68, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.722611427307129  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.722611427307129  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.72274112701416  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.739212989807129  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([78, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.740647792816162  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.740647792816162  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.740796566009521  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.760732173919678  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([83, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.76242971420288  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.76242971420288  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.762588024139404  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.784909725189209  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.786421298980713  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.786421298980713  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.786562442779541  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.807451725006104  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.80915355682373  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.80915355682373  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.809300422668457  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.832064628601074  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([95, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.834742546081543  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.834742546081543  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.83492374420166  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.864277839660645  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([77, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.865972518920898  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.865972518920898  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 21.46875 GB
    Memory Allocated: 9.866119384765625  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 9.890939712524414  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([19585, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 10.361457347869873  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 10.361457347869873  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 19585, 256]), torch.Size([1, 19585, 256])
----------------------------------------3
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 10.400402069091797  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 16.992880821228027  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 19585, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 16.505343437194824  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 16.509056568145752  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 16.50883436203003  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.474609375 GB
    Memory Allocated: 16.512547969818115  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.22816848754882812  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

pseudo mini batch 4 input nodes size: 494887
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.20386075973510742  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.20386075973510742  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.38822078704833984  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.38838863372802734  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.24304437637329102  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.26137828826904297  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.26137828826904297  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.478515625 GB
    Memory Allocated: 0.26137828826904297  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

m.shape torch.Size([231, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9770612716674805  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9770612716674805  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 231, 100]), torch.Size([1, 231, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.97723388671875  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.978611946105957  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 231, 100])
m.shape torch.Size([284, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9787373542785645  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9787373542785645  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 284, 100]), torch.Size([1, 284, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9789490699768066  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9821248054504395  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 284, 100])
m.shape torch.Size([374, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9824371337890625  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9824371337890625  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9827165603637695  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9888510704040527  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([457, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9893927574157715  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9893927574157715  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 457, 100]), torch.Size([1, 457, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9897341728210449  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 0.9996180534362793  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 457, 100])
m.shape torch.Size([502, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.000382423400879  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.000382423400879  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 502, 100]), torch.Size([1, 502, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0007572174072266  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.014228343963623  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 502, 100])
m.shape torch.Size([591, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0163030624389648  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0163030624389648  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 591, 100]), torch.Size([1, 591, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0167436599731445  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0356807708740234  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 591, 100])
m.shape torch.Size([671, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.038167953491211  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.038167953491211  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 671, 100]), torch.Size([1, 671, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0386686325073242  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0656661987304688  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 671, 100])
m.shape torch.Size([719, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.067558765411377  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.067558765411377  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 719, 100]), torch.Size([1, 719, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0680947303771973  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.0991463661193848  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 719, 100])
m.shape torch.Size([749, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.1013898849487305  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.1013898849487305  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 749, 100]), torch.Size([1, 749, 100])
----------------------------------------3
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.1019487380981445  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.173828125 GB
    Memory Allocated: 1.1385016441345215  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 749, 100])
m.shape torch.Size([183628, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.859375 GB
    Memory Allocated: 1.8222899436950684  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.859375 GB
    Memory Allocated: 1.8222899436950684  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 183628, 100]), torch.Size([1, 183628, 100])
----------------------------------------3
 Nvidia-smi: 22.859375 GB
    Memory Allocated: 1.959104061126709  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.672877788543701  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 183628, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 10.976548671722412  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.156035900115967  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.378953456878662  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.91379976272583  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.91379976272583  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.913816928863525  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.913954257965088  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.913951873779297  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.913951873779297  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.913957595825195  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.914043426513672  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([23, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.914107322692871  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.914107322692871  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.914151191711426  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.915116310119629  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.91515588760376  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.91515588760376  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.915186405181885  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.91607141494751  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.916133403778076  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.916133403778076  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.916163921356201  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.917262554168701  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.917328357696533  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.917328357696533  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.917355060577393  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.918503284454346  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.918618202209473  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.918618202209473  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.918654441833496  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.920466423034668  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.920509815216064  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.920509815216064  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.920525074005127  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.92139482498169  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([31, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.921655654907227  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.921655654907227  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 16.71484375 GB
    Memory Allocated: 11.921714782714844  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.716796875 GB
    Memory Allocated: 11.925498962402344  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.716796875 GB
    Memory Allocated: 11.925604343414307  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.716796875 GB
    Memory Allocated: 11.925604343414307  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 16.716796875 GB
    Memory Allocated: 11.925631046295166  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.71875 GB
    Memory Allocated: 11.927526950836182  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.71875 GB
    Memory Allocated: 11.927672386169434  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.71875 GB
    Memory Allocated: 11.927672386169434  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 16.71875 GB
    Memory Allocated: 11.927700996398926  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.72265625 GB
    Memory Allocated: 11.929932594299316  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([26, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.72265625 GB
    Memory Allocated: 11.93021821975708  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.72265625 GB
    Memory Allocated: 11.93021821975708  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 16.72265625 GB
    Memory Allocated: 11.930267810821533  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7265625 GB
    Memory Allocated: 11.934483051300049  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.7265625 GB
    Memory Allocated: 11.934858322143555  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7265625 GB
    Memory Allocated: 11.934858322143555  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.7265625 GB
    Memory Allocated: 11.934919357299805  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.732421875 GB
    Memory Allocated: 11.940534591674805  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.732421875 GB
    Memory Allocated: 11.940746307373047  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.732421875 GB
    Memory Allocated: 11.940746307373047  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 16.732421875 GB
    Memory Allocated: 11.940780639648438  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.736328125 GB
    Memory Allocated: 11.94417953491211  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.736328125 GB
    Memory Allocated: 11.944695949554443  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.736328125 GB
    Memory Allocated: 11.944695949554443  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 16.736328125 GB
    Memory Allocated: 11.944766521453857  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.744140625 GB
    Memory Allocated: 11.952247142791748  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.744140625 GB
    Memory Allocated: 11.952703952789307  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.744140625 GB
    Memory Allocated: 11.952703952789307  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.744140625 GB
    Memory Allocated: 11.952764987945557  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.751953125 GB
    Memory Allocated: 11.959661960601807  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.751953125 GB
    Memory Allocated: 11.959974765777588  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.751953125 GB
    Memory Allocated: 11.959974765777588  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 16.751953125 GB
    Memory Allocated: 11.960014820098877  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.7578125 GB
    Memory Allocated: 11.964821338653564  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([45, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.7578125 GB
    Memory Allocated: 11.965579986572266  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7578125 GB
    Memory Allocated: 11.965579986572266  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 16.7578125 GB
    Memory Allocated: 11.965665817260742  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.76953125 GB
    Memory Allocated: 11.976566314697266  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.76953125 GB
    Memory Allocated: 11.977272510528564  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.76953125 GB
    Memory Allocated: 11.977272510528564  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 16.76953125 GB
    Memory Allocated: 11.97735071182251  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.78125 GB
    Memory Allocated: 11.987829685211182  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([60, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.78125 GB
    Memory Allocated: 11.9889497756958  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.78125 GB
    Memory Allocated: 11.9889497756958  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 16.78125 GB
    Memory Allocated: 11.98906421661377  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.796875 GB
    Memory Allocated: 12.005200386047363  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.796875 GB
    Memory Allocated: 12.006235122680664  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.796875 GB
    Memory Allocated: 12.006235122680664  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 16.796875 GB
    Memory Allocated: 12.006330490112305  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.810546875 GB
    Memory Allocated: 12.020444869995117  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.810546875 GB
    Memory Allocated: 12.021179676055908  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.810546875 GB
    Memory Allocated: 12.021179676055908  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 16.810546875 GB
    Memory Allocated: 12.021250247955322  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.822265625 GB
    Memory Allocated: 12.032188892364502  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.822265625 GB
    Memory Allocated: 12.032728672027588  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.822265625 GB
    Memory Allocated: 12.032728672027588  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 16.822265625 GB
    Memory Allocated: 12.032778263092041  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.83203125 GB
    Memory Allocated: 12.040812015533447  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.83203125 GB
    Memory Allocated: 12.04216480255127  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.83203125 GB
    Memory Allocated: 12.04216480255127  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 16.83203125 GB
    Memory Allocated: 12.04226016998291  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.84765625 GB
    Memory Allocated: 12.058377265930176  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([21825, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.84765625 GB
    Memory Allocated: 12.582743644714355  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.84765625 GB
    Memory Allocated: 12.582743644714355  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

 h.shape torch.Size([1, 21825, 256]), torch.Size([1, 21825, 256])
----------------------------------------3
 Nvidia-smi: 16.84765625 GB
    Memory Allocated: 12.624371528625488  GigaBytes
Max Memory Allocated: 18.72715663909912  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.62890625 GB
    Memory Allocated: 20.00715923309326  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 21825, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.62890625 GB
    Memory Allocated: 19.476211071014404  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.62890625 GB
    Memory Allocated: 19.48014497756958  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.62890625 GB
    Memory Allocated: 19.48019790649414  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.62890625 GB
    Memory Allocated: 19.484132289886475  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.2852482795715332  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

pseudo mini batch 5 input nodes size: 445759
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.25678157806396484  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.25678157806396484  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.4228401184082031  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.4230074882507324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.2384796142578125  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.2566108703613281  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.2566108703613281  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.2566108703613281  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

m.shape torch.Size([242, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9248127937316895  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9248127937316895  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 242, 100]), torch.Size([1, 242, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9249939918518066  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9264392852783203  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 242, 100])
m.shape torch.Size([388, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.926638126373291  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.926638126373291  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 388, 100]), torch.Size([1, 388, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9269280433654785  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9312682151794434  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 388, 100])
m.shape torch.Size([750, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9319615364074707  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9319615364074707  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 750, 100]), torch.Size([1, 750, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9325203895568848  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9465217590332031  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 750, 100])
m.shape torch.Size([1296, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.948697566986084  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.948697566986084  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1296, 100]), torch.Size([1, 1296, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9496636390686035  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9782242774963379  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1296, 100])
m.shape torch.Size([1779, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9810552597045898  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9810552597045898  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1779, 100]), torch.Size([1, 1779, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 0.9823808670043945  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.031045913696289  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1779, 100])
m.shape torch.Size([1962, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.0347685813903809  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.0347685813903809  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1962, 100]), torch.Size([1, 1962, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.0362305641174316  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.0992193222045898  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1962, 100])
m.shape torch.Size([2262, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.1043872833251953  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.1043872833251953  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 2262, 100]), torch.Size([1, 2262, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.1060733795166016  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.1926617622375488  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 2262, 100])
m.shape torch.Size([2486, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.1993474960327148  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.1993474960327148  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 2486, 100]), torch.Size([1, 2486, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.2012004852294922  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.3067865371704102  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 2486, 100])
m.shape torch.Size([2568, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.3144702911376953  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.3144702911376953  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 2568, 100]), torch.Size([1, 2568, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.3163843154907227  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 1.4388432502746582  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 2568, 100])
m.shape torch.Size([164898, 10, 100])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 2.0521793365478516  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 2.0521793365478516  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 164898, 100]), torch.Size([1, 164898, 100])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 2.1750383377075195  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 10.8980131149292  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 164898, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 10.252766609191895  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 10.42312240600586  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 10.634227752685547  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.154750347137451  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.154750347137451  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.15476369857788  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.154870510101318  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.154879570007324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.154879570007324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.154894828796387  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.155123710632324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([22, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.155179977416992  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.155179977416992  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.155221939086914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.156145095825195  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([42, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.156285762786865  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.156285762786865  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.156365871429443  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.158689022064209  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.15880298614502  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.15880298614502  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.15886402130127  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.16106128692627  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([55, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.161348342895508  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.161348342895508  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.161453247070312  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.165964126586914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([84, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.16647720336914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.16647720336914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.166637420654297  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.17464828491211  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([59, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.17502212524414  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.17502212524414  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.175134658813477  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.181549072265625  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([82, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.182202339172363  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.182202339172363  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.182358741760254  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.192368507385254  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([118, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.193528175354004  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.193528175354004  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.193753242492676  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.209733009338379  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([123, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.21102523803711  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.21102523803711  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.211259841918945  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.229558944702148  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([100, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.230684280395508  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.230684280395508  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.230875015258789  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.247087478637695  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([90, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.24858283996582  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.24858283996582  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.248754501342773  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.264547348022461  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([131, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.26631498336792  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.26631498336792  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 23.1640625 GB
    Memory Allocated: 11.266564846038818  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.166015625 GB
    Memory Allocated: 11.291301250457764  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([117, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.166015625 GB
    Memory Allocated: 11.293540954589844  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.166015625 GB
    Memory Allocated: 11.293540954589844  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 23.166015625 GB
    Memory Allocated: 11.293764114379883  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.189453125 GB
    Memory Allocated: 11.317419052124023  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([123, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.189453125 GB
    Memory Allocated: 11.319673538208008  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.189453125 GB
    Memory Allocated: 11.319673538208008  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 23.189453125 GB
    Memory Allocated: 11.319908142089844  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.216796875 GB
    Memory Allocated: 11.346418380737305  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([91, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.216796875 GB
    Memory Allocated: 11.34797477722168  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.216796875 GB
    Memory Allocated: 11.34797477722168  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 23.216796875 GB
    Memory Allocated: 11.348148345947266  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.23828125 GB
    Memory Allocated: 11.368976593017578  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([118, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.23828125 GB
    Memory Allocated: 11.371484756469727  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.23828125 GB
    Memory Allocated: 11.371484756469727  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 23.23828125 GB
    Memory Allocated: 11.371709823608398  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.267578125 GB
    Memory Allocated: 11.400293350219727  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.267578125 GB
    Memory Allocated: 11.402007102966309  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.267578125 GB
    Memory Allocated: 11.402007102966309  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 23.267578125 GB
    Memory Allocated: 11.40219783782959  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.29296875 GB
    Memory Allocated: 11.427756309509277  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([89, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.29296875 GB
    Memory Allocated: 11.42937183380127  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.29296875 GB
    Memory Allocated: 11.42937183380127  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 23.29296875 GB
    Memory Allocated: 11.42954158782959  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.31640625 GB
    Memory Allocated: 11.453476905822754  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([106, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.31640625 GB
    Memory Allocated: 11.45637035369873  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.31640625 GB
    Memory Allocated: 11.45637035369873  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 23.318359375 GB
    Memory Allocated: 11.456572532653809  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.34765625 GB
    Memory Allocated: 11.486495018005371  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([115, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.34765625 GB
    Memory Allocated: 11.48937463760376  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.34765625 GB
    Memory Allocated: 11.48937463760376  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 23.34765625 GB
    Memory Allocated: 11.489593982696533  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.3828125 GB
    Memory Allocated: 11.523592472076416  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([127, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.3828125 GB
    Memory Allocated: 11.526466369628906  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.3828125 GB
    Memory Allocated: 11.526466369628906  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 23.384765625 GB
    Memory Allocated: 11.526708602905273  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.423828125 GB
    Memory Allocated: 11.565950393676758  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([82, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.423828125 GB
    Memory Allocated: 11.567720890045166  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.423828125 GB
    Memory Allocated: 11.567720890045166  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 23.423828125 GB
    Memory Allocated: 11.567877292633057  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 11.594309329986572  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([20399, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 12.084381103515625  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 12.084381103515625  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 20399, 256]), torch.Size([1, 20399, 256])
----------------------------------------3
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 12.123289108276367  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 18.972004890441895  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 20399, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 18.458538055419922  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 18.46280860900879  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 18.46263313293457  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.44921875 GB
    Memory Allocated: 18.466559410095215  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.2816452980041504  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

pseudo mini batch 6 input nodes size: 505612
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.253690242767334  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.253690242767334  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.4420456886291504  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.44220733642578125  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.27598142623901367  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.2930479049682617  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.2930479049682617  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.2930479049682617  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

m.shape torch.Size([302, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9547319412231445  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9547319412231445  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 302, 100]), torch.Size([1, 302, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9549570083618164  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9567575454711914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 302, 100])
m.shape torch.Size([455, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9569840431213379  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9569840431213379  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 455, 100]), torch.Size([1, 455, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9573235511779785  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9624104499816895  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 455, 100])
m.shape torch.Size([747, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9630756378173828  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9630756378173828  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 747, 100]), torch.Size([1, 747, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9636325836181641  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9768095016479492  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 747, 100])
m.shape torch.Size([844, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9777889251708984  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9777889251708984  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 844, 100]), torch.Size([1, 844, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9784183502197266  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9968767166137695  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 844, 100])
m.shape torch.Size([1013, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9984493255615234  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9984493255615234  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1013, 100]), torch.Size([1, 1013, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 0.9992046356201172  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.0273160934448242  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1013, 100])
m.shape torch.Size([1095, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.029386043548584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.029386043548584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1095, 100]), torch.Size([1, 1095, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.0302023887634277  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.0659680366516113  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1095, 100])
m.shape torch.Size([1275, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.0688848495483398  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.0688848495483398  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1275, 100]), torch.Size([1, 1275, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.0698356628417969  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.1178374290466309  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1275, 100])
m.shape torch.Size([1271, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.121150016784668  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.121150016784668  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1271, 100]), torch.Size([1, 1271, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.1220970153808594  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.1776795387268066  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1271, 100])
m.shape torch.Size([1259, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.1814274787902832  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.1814274787902832  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 1259, 100]), torch.Size([1, 1259, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.182365894317627  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.2441163063049316  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 1259, 100])
m.shape torch.Size([167362, 10, 100])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.867119312286377  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.867119312286377  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 167362, 100]), torch.Size([1, 167362, 100])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 1.991814136505127  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 10.84513235092163  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 167362, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 10.2033109664917  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 10.370798110961914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 10.57871150970459  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

m.shape torch.Size([30, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.058463096618652  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.058463096618652  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.058520317077637  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.058978080749512  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([60, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.059064865112305  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.059064865112305  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.059179306030273  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.060895919799805  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([143, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.061251163482666  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.061251163482666  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.061523914337158  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.067524433135986  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([142, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.067934036254883  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.067934036254883  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.068204879760742  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.076059341430664  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([149, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.076640129089355  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.076640129089355  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 149, 256]), torch.Size([1, 149, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.076924324035645  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.08715534210205  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 149, 256])
m.shape torch.Size([190, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.08823299407959  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.08823299407959  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 190, 256]), torch.Size([1, 190, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.088595390319824  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.104178428649902  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 190, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.10582160949707  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.10582160949707  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.106307983398438  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.130626678466797  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([136, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.131434440612793  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.131434440612793  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.131693840026855  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.146479606628418  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([154, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.147682189941406  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.147682189941406  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.14797592163086  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.16677474975586  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([201, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.168560028076172  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.168560028076172  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.168943405151367  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.196163177490234  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([173, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.197800636291504  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.197800636291504  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.19813060760498  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.223868370056152  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([164, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.225594997406006  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.225594997406006  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.225907802581787  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.252496242523193  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([145, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.254151821136475  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.254151821136475  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.254428386688232  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.279872417449951  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([210, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.282559871673584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.282559871673584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 210, 256]), torch.Size([1, 210, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.282960414886475  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.322614192962646  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 210, 256])
m.shape torch.Size([203, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.325340747833252  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.325340747833252  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 203, 256]), torch.Size([1, 203, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.325727939605713  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.366770267486572  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 203, 256])
m.shape torch.Size([154, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.368945121765137  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.368945121765137  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.36923885345459  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.402430534362793  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([106, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.40438985824585  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.40438985824585  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.404592037200928  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.428853511810303  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([129, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.430984497070312  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.430984497070312  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 129, 256]), torch.Size([1, 129, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.431230545043945  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.462478637695312  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 129, 256])
m.shape torch.Size([101, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.464200019836426  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.464200019836426  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.46439266204834  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.490206718444824  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([114, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.492301940917969  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.492301940917969  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.49251937866211  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.523178100585938  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([117, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.525431156158447  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.525431156158447  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 23.453125 GB
    Memory Allocated: 11.525654315948486  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.478515625 GB
    Memory Allocated: 11.558681964874268  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([87, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.478515625 GB
    Memory Allocated: 11.560410022735596  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.478515625 GB
    Memory Allocated: 11.560410022735596  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 23.478515625 GB
    Memory Allocated: 11.56057596206665  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.50390625 GB
    Memory Allocated: 11.586296558380127  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([140, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.50390625 GB
    Memory Allocated: 11.589674949645996  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.50390625 GB
    Memory Allocated: 11.589674949645996  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 140, 256]), torch.Size([1, 140, 256])
----------------------------------------3
 Nvidia-smi: 23.50390625 GB
    Memory Allocated: 11.58994197845459  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 11.633200645446777  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 140, 256])
m.shape torch.Size([148, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 11.636481285095215  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 11.636481285095215  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 148, 256]), torch.Size([1, 148, 256])
----------------------------------------3
 Nvidia-smi: 23.548828125 GB
    Memory Allocated: 11.636763572692871  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 11.684470176696777  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 148, 256])
m.shape torch.Size([18185, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 12.121280670166016  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 12.121280670166016  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 18185, 256]), torch.Size([1, 18185, 256])
----------------------------------------3
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 12.155965805053711  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 18.26063108444214  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 18185, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 17.788952827453613  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 17.793094635009766  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 17.79280424118042  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.595703125 GB
    Memory Allocated: 17.79694652557373  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.31599950790405273  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

pseudo mini batch 7 input nodes size: 455983
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.289151668548584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.289151668548584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.4590187072753906  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.4591865539550781  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.27066946029663086  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.28894758224487305  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.28894758224487305  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.599609375 GB
    Memory Allocated: 0.28894758224487305  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

m.shape torch.Size([263, 1, 100])
----------------------------------------1
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0168733596801758  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0168733596801758  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 263, 100]), torch.Size([1, 263, 100])
----------------------------------------3
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0170698165893555  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0186386108398438  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 263, 100])
m.shape torch.Size([413, 2, 100])
----------------------------------------1
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0188484191894531  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0188484191894531  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 413, 100]), torch.Size([1, 413, 100])
----------------------------------------3
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0191564559936523  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.16015625 GB
    Memory Allocated: 1.0237741470336914  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 413, 100])
m.shape torch.Size([448, 3, 100])
----------------------------------------1
 Nvidia-smi: 4.162109375 GB
    Memory Allocated: 1.024120807647705  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.162109375 GB
    Memory Allocated: 1.024120807647705  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 448, 100]), torch.Size([1, 448, 100])
----------------------------------------3
 Nvidia-smi: 4.162109375 GB
    Memory Allocated: 1.0244545936584473  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.169921875 GB
    Memory Allocated: 1.0317978858947754  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 448, 100])
m.shape torch.Size([557, 4, 100])
----------------------------------------1
 Nvidia-smi: 4.169921875 GB
    Memory Allocated: 1.032461166381836  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.169921875 GB
    Memory Allocated: 1.032461166381836  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 557, 100]), torch.Size([1, 557, 100])
----------------------------------------3
 Nvidia-smi: 4.169921875 GB
    Memory Allocated: 1.032876968383789  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.18359375 GB
    Memory Allocated: 1.0449180603027344  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 557, 100])
m.shape torch.Size([640, 5, 100])
----------------------------------------1
 Nvidia-smi: 4.18359375 GB
    Memory Allocated: 1.0459437370300293  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.18359375 GB
    Memory Allocated: 1.0459437370300293  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 640, 100]), torch.Size([1, 640, 100])
----------------------------------------3
 Nvidia-smi: 4.18359375 GB
    Memory Allocated: 1.0464205741882324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.201171875 GB
    Memory Allocated: 1.063586711883545  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 640, 100])
m.shape torch.Size([755, 6, 100])
----------------------------------------1
 Nvidia-smi: 4.201171875 GB
    Memory Allocated: 1.065187931060791  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.201171875 GB
    Memory Allocated: 1.065187931060791  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 755, 100]), torch.Size([1, 755, 100])
----------------------------------------3
 Nvidia-smi: 4.201171875 GB
    Memory Allocated: 1.0657505989074707  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.20703125 GB
    Memory Allocated: 1.0915803909301758  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 755, 100])
m.shape torch.Size([875, 7, 100])
----------------------------------------1
 Nvidia-smi: 4.20703125 GB
    Memory Allocated: 1.0943403244018555  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.20703125 GB
    Memory Allocated: 1.0943403244018555  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 875, 100]), torch.Size([1, 875, 100])
----------------------------------------3
 Nvidia-smi: 4.20703125 GB
    Memory Allocated: 1.0949926376342773  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.212890625 GB
    Memory Allocated: 1.1283178329467773  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 875, 100])
m.shape torch.Size([907, 8, 100])
----------------------------------------1
 Nvidia-smi: 4.212890625 GB
    Memory Allocated: 1.1311593055725098  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.212890625 GB
    Memory Allocated: 1.1311593055725098  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 907, 100]), torch.Size([1, 907, 100])
----------------------------------------3
 Nvidia-smi: 4.212890625 GB
    Memory Allocated: 1.1318354606628418  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.220703125 GB
    Memory Allocated: 1.1703648567199707  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 907, 100])
m.shape torch.Size([952, 9, 100])
----------------------------------------1
 Nvidia-smi: 4.220703125 GB
    Memory Allocated: 1.1732187271118164  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.220703125 GB
    Memory Allocated: 1.1732187271118164  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 952, 100]), torch.Size([1, 952, 100])
----------------------------------------3
 Nvidia-smi: 4.220703125 GB
    Memory Allocated: 1.1739282608032227  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.228515625 GB
    Memory Allocated: 1.2200627326965332  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 952, 100])
m.shape torch.Size([186007, 10, 100])
----------------------------------------1
 Nvidia-smi: 4.923828125 GB
    Memory Allocated: 1.91306734085083  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.923828125 GB
    Memory Allocated: 1.91306734085083  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 186007, 100]), torch.Size([1, 186007, 100])
----------------------------------------3
 Nvidia-smi: 4.923828125 GB
    Memory Allocated: 2.0516533851623535  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.44140625 GB
    Memory Allocated: 11.895897388458252  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 186007, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.44140625 GB
    Memory Allocated: 11.188304424285889  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.44140625 GB
    Memory Allocated: 11.371235370635986  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.44140625 GB
    Memory Allocated: 11.598088264465332  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136417865753174  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136417865753174  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136423587799072  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.13646936416626  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136474609375  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136474609375  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136482238769531  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.1365966796875  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136613368988037  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136613368988037  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136626720428467  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.13692045211792  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136940956115723  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136940956115723  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.136954307556152  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.137341499328613  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.137378215789795  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.137378215789795  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.13739538192749  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138013362884521  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138033866882324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138033866882324  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138043403625488  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138453483581543  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([16, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138556480407715  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.138556480407715  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.13858699798584  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14011287689209  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.140228748321533  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.140228748321533  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.140261173248291  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.142109394073486  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.142266273498535  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.142266273498535  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.142304420471191  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.144745826721191  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14485216140747  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14485216140747  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.144876956939697  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.146637439727783  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14672040939331  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14672040939331  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.146737575531006  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14807653427124  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14817190170288  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.14817190170288  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.974609375 GB
    Memory Allocated: 12.148189067840576  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9765625 GB
    Memory Allocated: 12.149648189544678  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.9765625 GB
    Memory Allocated: 12.14977741241455  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9765625 GB
    Memory Allocated: 12.14977741241455  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.9765625 GB
    Memory Allocated: 12.149798393249512  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.978515625 GB
    Memory Allocated: 12.151728630065918  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.978515625 GB
    Memory Allocated: 12.151960372924805  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.978515625 GB
    Memory Allocated: 12.151960372924805  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.978515625 GB
    Memory Allocated: 12.151994705200195  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.982421875 GB
    Memory Allocated: 12.155393600463867  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.982421875 GB
    Memory Allocated: 12.155506610870361  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.982421875 GB
    Memory Allocated: 12.155506610870361  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.982421875 GB
    Memory Allocated: 12.155523777008057  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.984375 GB
    Memory Allocated: 12.15734338760376  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.984375 GB
    Memory Allocated: 12.15755033493042  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.984375 GB
    Memory Allocated: 12.15755033493042  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.984375 GB
    Memory Allocated: 12.15757703781128  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.986328125 GB
    Memory Allocated: 12.160594463348389  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.986328125 GB
    Memory Allocated: 12.160908222198486  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.986328125 GB
    Memory Allocated: 12.160908222198486  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.986328125 GB
    Memory Allocated: 12.160946369171143  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9921875 GB
    Memory Allocated: 12.165524005889893  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.9921875 GB
    Memory Allocated: 12.165955066680908  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9921875 GB
    Memory Allocated: 12.165955066680908  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.9921875 GB
    Memory Allocated: 12.166004657745361  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0 GB
    Memory Allocated: 12.172302722930908  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.0 GB
    Memory Allocated: 12.172862529754639  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0 GB
    Memory Allocated: 12.172862529754639  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.0 GB
    Memory Allocated: 12.172923564910889  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0078125 GB
    Memory Allocated: 12.181102275848389  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.0078125 GB
    Memory Allocated: 12.181552410125732  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0078125 GB
    Memory Allocated: 12.181552410125732  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.0078125 GB
    Memory Allocated: 12.181600093841553  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.015625 GB
    Memory Allocated: 12.188323497772217  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.015625 GB
    Memory Allocated: 12.188541889190674  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.015625 GB
    Memory Allocated: 12.188541889190674  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.015625 GB
    Memory Allocated: 12.188564777374268  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.017578125 GB
    Memory Allocated: 12.191952228546143  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.01953125 GB
    Memory Allocated: 12.192659854888916  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.01953125 GB
    Memory Allocated: 12.192659854888916  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.01953125 GB
    Memory Allocated: 12.192724704742432  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.029296875 GB
    Memory Allocated: 12.202776432037354  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.029296875 GB
    Memory Allocated: 12.203208446502686  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.029296875 GB
    Memory Allocated: 12.203208446502686  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 15.029296875 GB
    Memory Allocated: 12.203248500823975  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.037109375 GB
    Memory Allocated: 12.209737300872803  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.037109375 GB
    Memory Allocated: 12.210617065429688  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.037109375 GB
    Memory Allocated: 12.210617065429688  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.037109375 GB
    Memory Allocated: 12.210691452026367  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.05078125 GB
    Memory Allocated: 12.223262786865234  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([22106, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.578125 GB
    Memory Allocated: 12.754687309265137  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.578125 GB
    Memory Allocated: 12.754687309265137  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

 h.shape torch.Size([1, 22106, 256]), torch.Size([1, 22106, 256])
----------------------------------------3
 Nvidia-smi: 15.578125 GB
    Memory Allocated: 12.79685115814209  GigaBytes
Max Memory Allocated: 20.527507781982422  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.701171875 GB
    Memory Allocated: 20.234993934631348  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 22106, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.701171875 GB
    Memory Allocated: 19.700941562652588  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.701171875 GB
    Memory Allocated: 19.705148220062256  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.701171875 GB
    Memory Allocated: 19.7047758102417  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.701171875 GB
    Memory Allocated: 19.70871353149414  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.3130607604980469  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

pseudo mini batch 8 input nodes size: 483768
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.2841153144836426  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.2841153144836426  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.46433305740356445  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.46449947357177734  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.2944645881652832  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.3127732276916504  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.3127732276916504  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.4921875 GB
    Memory Allocated: 0.3127732276916504  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

m.shape torch.Size([296, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0446710586547852  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0446710586547852  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 296, 100]), torch.Size([1, 296, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0448923110961914  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0466580390930176  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 296, 100])
m.shape torch.Size([361, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0468168258666992  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0468168258666992  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 361, 100]), torch.Size([1, 361, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0470867156982422  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.051126480102539  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 361, 100])
m.shape torch.Size([424, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0514655113220215  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0514655113220215  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 424, 100]), torch.Size([1, 424, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0517821311950684  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0587348937988281  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 424, 100])
m.shape torch.Size([507, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0593323707580566  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0593323707580566  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 507, 100]), torch.Size([1, 507, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.05971097946167  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0706734657287598  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 507, 100])
m.shape torch.Size([538, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0716161727905273  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0716161727905273  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 538, 100]), torch.Size([1, 538, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0720176696777344  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0864572525024414  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 538, 100])
m.shape torch.Size([609, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0881752967834473  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0881752967834473  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 609, 100]), torch.Size([1, 609, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.0886292457580566  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1081490516662598  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 609, 100])
m.shape torch.Size([702, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.109753131866455  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.109753131866455  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 702, 100]), torch.Size([1, 702, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.110276699066162  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1382660865783691  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 702, 100])
m.shape torch.Size([780, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1403288841247559  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1403288841247559  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 780, 100]), torch.Size([1, 780, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1409106254577637  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1740469932556152  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 780, 100])
m.shape torch.Size([935, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1768913269042969  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1768913269042969  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 935, 100]), torch.Size([1, 935, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.1775884628295898  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.22352933883667  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 935, 100])
m.shape torch.Size([187113, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.9202313423156738  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 1.9202313423156738  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 187113, 100]), torch.Size([1, 187113, 100])
----------------------------------------3
 Nvidia-smi: 17.201171875 GB
    Memory Allocated: 2.060856342315674  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 11.977148532867432  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 187113, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 11.265405178070068  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 11.448763370513916  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 11.67615032196045  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210083961486816  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210083961486816  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210104942321777  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210419654846191  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210455417633057  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210455417633057  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.210485935211182  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211157321929932  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211161613464355  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211161613464355  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.21117115020752  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211447715759277  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211472034454346  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211472034454346  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211483478546143  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.21189546585083  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211965084075928  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211965084075928  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.211989879608154  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213056087493896  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213064193725586  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213064193725586  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213069915771484  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213356018066406  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213414669036865  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213414669036865  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.213429927825928  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.21429967880249  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.214413166046143  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.214413166046143  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.214439868927002  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.216148853302002  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.216203212738037  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.216203212738037  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.216216564178467  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.217164516448975  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.217274188995361  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.217274188995361  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.217295169830322  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.218931674957275  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([22, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.219175338745117  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.219175338745117  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.219217300415039  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.222784042358398  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.223100662231445  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.223100662231445  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.223152160644531  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.227890014648438  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.228025913238525  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.228025913238525  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.22804880142212  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.2303147315979  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.230433464050293  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.230433464050293  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.230450630187988  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.232270240783691  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.232369422912598  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.232369422912598  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.232382774353027  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.233891487121582  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.23404836654663  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.23404836654663  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.234067440032959  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.236356258392334  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.236588954925537  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.236588954925537  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.236615657806396  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.240006923675537  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.240249633789062  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.240249633789062  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.240276336669922  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.243854522705078  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.244033813476562  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.244033813476562  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.24405288696289  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.246742248535156  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.247096061706543  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.247096061706543  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.247130393981934  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.252211570739746  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.252532958984375  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.252532958984375  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.2525634765625  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.257293701171875  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.257919788360596  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.257919788360596  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.257975101470947  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.2669358253479  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([27, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.267531394958496  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.267531394958496  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.267582893371582  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.276286125183105  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22002, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.804977893829346  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.804977893829346  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

 h.shape torch.Size([1, 22002, 256]), torch.Size([1, 22002, 256])
----------------------------------------3
 Nvidia-smi: 23.205078125 GB
    Memory Allocated: 12.847445011138916  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 20.233853816986084  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

rst.shape  torch.Size([1, 22002, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 19.704784870147705  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 19.708962440490723  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 19.709157466888428  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8984375 GB
    Memory Allocated: 19.713726043701172  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.431640625 GB
    Memory Allocated: 0.33669233322143555  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.431640625 GB
    Memory Allocated: 0.3417792320251465  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.431640625 GB
    Memory Allocated: 0.3417792320251465  GigaBytes
Max Memory Allocated: 20.762337684631348  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.13995040787590873 |0.046279191970825195 |0.3204060130649143 |0.00013478597005208334 |0.24004671308729383 |0.0071828365325927734 |
----------------------------------------------------------pseudo_mini_loss sum 5.385978698730469
Total (block generation + training)time/epoch 64.31688499450684
Training time/epoch 6.863794326782227
Training time without block to device /epoch 6.4472815990448
Training time without total dataloading part /epoch 5.052470445632935
load block tensor time/epoch 1.2595536708831787
block to device time/epoch 0.41651272773742676
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5582482
Number of first layer input nodes during this epoch:  4016518
Number of first layer output nodes during this epoch:  1565964
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
